<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Home - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ActivationFunction.html">ActivationFunction</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="DecisionTree.html">DecisionTree</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Impurity.html">Impurity</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="NeuralNetwork.html">NeuralNetwork</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NeuralNetwork.html#predict">predict</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NeuralNetwork.html#setActivationFunction">setActivationFunction</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NeuralNetwork.html#setLearningRate">setLearningRate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NeuralNetwork.html#train">train</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Node.html">Node</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Perceptron.html">Perceptron</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Perceptron.html#.of">of</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Perceptron.html#predict">predict</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Perceptron.html#train">train</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#convert2frequencies">convert2frequencies</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#countClasses">countClasses</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#entropy">entropy</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#gini">gini</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#sigmoid">sigmoid</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#tanh">tanh</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#variance">variance</a></span></li>
</nav>

<div id="main">
    

    



    









    


    <section class="readme">
        <article><h1>funml</h1><p>Machine learning with functional undertones.</p>
<p><a href="https://travis-ci.org/astuanax/funml"><img src="https://travis-ci.org/astuanax/funml.svg?branch=master" alt="Build Status"></a> <a href="https://codeclimate.com/github/astuanax/funml/maintainability"><img src="https://api.codeclimate.com/v1/badges/8f95076a06e56ebada94/maintainability" alt="Maintainability"></a> <a href="https://codeclimate.com/github/astuanax/funml/test_coverage"><img src="https://api.codeclimate.com/v1/badges/8f95076a06e56ebada94/test_coverage" alt="Test Coverage"></a></p>
<h2>Perceptron</h2><p>A Perceptron class to learn and solve simple linear problems.</p>
<h3>Example: sonar.csv</h3><p>The sonar.csv file is used in this example. The example is better known as Sonar, Mines vs. Rocks and was used by Gorman and Sejnowski in their study of the classification of sonar signals using a neural network.
In this case we use to show the usage of the perceptron.</p>
<p>First we load the data and split it up between a training and test set.</p>
<pre class="prettyprint source lang-javascript"><code>var dataset = [...] // load sonar.csv
var train = dataset.filter((x, idx) => idx % 2 === 0)
var test = dataset.filter((x, idx) => idx % 2 !== 0)</code></pre><p>The learning rate and epoch were set at 0.1 and 1000. 
The epoch defines the iterations, and the learning rate sets the speed at which the training algorithm will adapt. </p>
<pre class="prettyprint source lang-javascript"><code>var epochs = 1000
var learningRate = 0.1</code></pre><p>Then the perceptron is initialised with an empty array.<br>The Perceptron accepts the weights from a previous training session so you can use it on the front end as a way to make decisions. </p>
<pre class="prettyprint source lang-javascript"><code>var p = Perceptron.of([])
p.train(train, learningRate, epochs)</code></pre><p>The last step is to verify the success rate, which currently is a little over 70%. 
This can be improved using a multi layered neural network of course, but the Perceptron is just 1 neuron. </p>
<pre class="prettyprint source lang-javascript"><code>var successRate = [test.map(function (x, idx) {
      var row = x.slice(0, -1)
      var pred = p.predict(row)
      return [idx + ': ', pred === x[x.length - 1], pred, x[x.length - 1]]
    })].map(function (x, idx, arr) {
      var success = arr.filter(y => y[1])
      var avg = success.length / x.length
      return (avg * 100)
    }).reduce((result, x) => (result += x), 0)</code></pre><h2>NeuralNetwork</h2><p>The NeuralNetwork can be used to learn from the sonar.csv dataset. The <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.299.8959&amp;rep=rep1&amp;type=pdf">initial paper</a> uses 60 input layers, 3 hidden layers, and 1 output layer.
We will use around 66% of the data set to train the neural network and 33% to verify its acurracy</p>
<pre class="prettyprint source lang-javascript"><code>const dataset = load(&quot;sonar.csv&quot;) //load dataset

const train = dataset.filter((x, idx) => idx % 3 !== 0)
const test = dataset.filter((x, idx) => idx % 3 === 0)

let nn = new NeuralNetwork(60, 3, 1)</code></pre><p>Now we can start training the nn, and we will use a 10000 iterations and use the training set for each iteration.</p>
<pre class="prettyprint source lang-javascript"><code>
for (let i = 0; i &lt; 1000; i++) {
  train.forEach(x => {
    const input = x.slice(0, -1).map(row => [row])
    const output = [[x[x.length - 1]]]
    nn.train(input, output)
  })
}
</code></pre><p>Using the remaining test set we  get around 88% accuracy, which is quite an improvement compared to the perceptron.</p>
<pre class="prettyprint source lang-javascript"><code>
let testResults = []
    test.forEach(y => {
      const input = y.map(x => [x])
      const output = input.pop()
      const result = nn.predict(input)
      testResults.push({
        output,
        result
      })
    })

    const correct = testResults.reduce((prev, next) => { return prev + (Math.round(next.result[0][0]) === next.output[0]) }, 0)
    const successRate = correct / testResults.length
    console.log(&quot;rate&quot;, successrate) //rate 0.8857142857142857</code></pre><h2>DecisionTree</h2><p>A simple decision tree using entropy and gini impurity functions.</p></article>
    </section>






</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Wed Nov 06 2019 14:29:47 GMT+0100 (Central European Standard Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>